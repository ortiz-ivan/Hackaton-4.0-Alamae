{% set site_title = site_title or SITE_TITLE or "FAIGOTHY ✶ accesorios hechos a mano" %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>{{ site_title }}</title>
  <meta name="description" content="Accesorios góticos hechos a mano: aros, collares, anillos, cinturones y prendas con estética alternativa. Diseños artesanales FAIGOTHY.">
  <meta name="theme-color" content="#000000">
  <link rel="canonical" href="{{ request.url_root.rstrip('/') ~ url_for('index') }}">

  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="{{ site_title }}">
  <meta property="og:description" content="Accesorios góticos hechos a mano. Descubrí FAIGOTHY.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ request.url_root }}">
  <meta property="og:image" content="{{ url_for('static', filename='img/og_default.jpg', _external=True) }}">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ site_title }}">
  <meta name="twitter:description" content="Accesorios góticos hechos a mano.">
  <meta name="twitter:image" content="{{ url_for('static', filename='img/og_default.jpg', _external=True) }}">

  <!-- Favicon / Icons -->
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/apple-touch-icon.png') }}">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fuente Playfair -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <!-- === CSS personalizado === -->
  <style>
    html, body { background:#fff; }
    .font-playfair { font-family: 'Times New Roman', serif; }
    :root{ --negro:#000; --borde:#e5e7eb; }

    body { display:flex; flex-direction:column; min-height:100vh; }
    main { flex-grow:1; }

    /* Navbar */
    #navbar { position:sticky; top:0; left:0; right:0; z-index:50; background:#fff; border-bottom:1px solid var(--borde); }
    .nav-inner{ max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; padding:12px 18px; position:relative; }
    .nav-title{ position:absolute; left:50%; transform:translateX(-50%); font-family:'Playfair Display', serif; font-weight:700; pointer-events:auto; }

    /* Overlay y paneles */
    .overlay{ position:fixed; inset:0; background: rgba(0,0,0,0.24); opacity:0; pointer-events:none; transition:opacity .2s; z-index:45;}
    .overlay.show{ opacity:1; pointer-events:auto; }

    #side-menu, .cart-panel{ transition:transform .25s; }
    #side-menu{ position:fixed; top:0; left:0; height:100%; width:90vw; max-width:340px; background:#fff; border-right:1px solid var(--borde); transform:translateX(-100%); z-index:60; }
    #side-menu.open{ transform:translateX(0); }
    .cart-panel{ position:fixed; top:0; right:0; height:100%; width:94vw; max-width:420px; background:#fff; transform:translateX(110%); border-left:1px solid var(--borde); z-index:70; }
    .cart-panel.open{ transform:translateX(0); }

    /* Botones */
    .btn { border-radius:12px; padding:.7rem 1rem; border:1px solid var(--borde); background:#f5f5f5; cursor:pointer; }
    .btn:hover{ background:#f0f0f0; }
    .btn:focus-visible{ outline:2px solid #000; outline-offset:2px; }
    .btn-primary{ background:#000; color:#fff !important; border-color:#000; }
    .btn-primary:hover{ filter:brightness(.95); }

    /* Carruseles */
    .carousel-wrap{ position:relative; }
    .carousel-track{
      display:flex; gap:16px; overflow-x:auto;
      -webkit-overflow-scrolling:touch; scroll-behavior:smooth; padding-bottom:10px;
      scroll-snap-type:x mandatory; scrollbar-width:none;
    }
    .carousel-track::-webkit-scrollbar{ display:none; }
    .card{ flex:0 0 auto; border:1px solid var(--borde); border-radius:12px; background:#fff; scroll-snap-align:start; min-width:82vw; }
    @media (min-width:480px){ .card{ min-width:60vw; } }
    @media (min-width:640px){ .card{ min-width:45vw; } }
    @media (min-width:768px){ .card{ min-width:31vw; } }
    @media (min-width:1024px){ .card{ min-width:23.5vw; } }

    .arrow-btn{ position:absolute; top:50%; transform:translateY(-50%); width:40px; height:40px; border:1px solid var(--borde); background:#fff; border-radius:999px; display:flex; align-items:center; justify-content:center; cursor:pointer; opacity:.9; }
    .arrow-left{ left:6px; } .arrow-right{ right:6px; }

    .section-spacing{ padding-top:48px; padding-bottom:48px; }
    .hidden{ display:none !important; }
    .container{ max-width:1200px; margin:0 auto; padding-left:1.25rem; padding-right:1.25rem; }
    @media (min-width:640px){ .container{ padding-left:1.5rem; padding-right:1.5rem; } }
    .img-clip { width:100%; aspect-ratio:1/1; object-fit:cover; border-top-left-radius:12px; border-top-right-radius:12px; }

    .no-scroll{ overflow:hidden; touch-action:none; }

    @media (prefers-reduced-motion: reduce) {
      .carousel-track{ scroll-behavior:auto; }
      .overlay, #side-menu, .cart-panel{ transition:none !important; }
    }
    @media (max-width:768px){ .nav-title{ font-size:14px; } }

    /* Mostrar submenú siempre en desktop */
    @media (min-width:1024px){
      #submenu-catalogo{ display:block !important; }
    }
  </style>
</head>
<body class="flex flex-col min-h-screen">

  <!-- NAVBAR -->
  <nav id="navbar">
    <div class="nav-inner">
      <button id="menu-btn" class="btn" aria-label="Abrir menú">☰</button>
      <a href="{{ url_for('index') }}" class="nav-title text-lg sm:text-xl font-playfair font-bold">FAIGOTHY</a>
      <div class="flex items-center gap-2">
        {% if current_user.is_authenticated %}
          {% if IS_ADMIN %}<a href="{{ url_for('admin.dashboard') }}" class="btn btn-primary">Admin</a>{% endif %}
          <a href="{{ url_for('auth.logout') }}" class="btn">Salir</a>
        {% else %}
          <a href="{{ url_for('auth.login') }}" class="btn">Iniciar sesión</a>
        {% endif %}
        <button id="open-cart" class="btn" aria-label="Abrir carrito">
          <div class="flex items-center gap-2">
            <span class="relative inline-flex">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.6 8h13.2L17 13M7 13h10"/>
              </svg>
              {% set _qty = (CART_QTY or 0)|int %}
              <span id="cart-count"
                    class="absolute -top-2 -right-2 min-w-[1.1rem] h-5 px-1 leading-5 text-center
                           text-white text-[11px] font-semibold bg-red-500 rounded-full shadow
                           ring-2 ring-white transition-transform duration-150
                           {% if _qty <= 0 %}hidden{% endif %}">
                {{ _qty }}
              </span>
            </span>
            <span>Carrito</span>
          </div>
        </button>
      </div>
    </div>
  </nav>

  <div id="overlay" class="overlay" aria-hidden="true"></div>

  <!-- SIDE MENU -->
  <aside id="side-menu" aria-label="Menú lateral" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="flex items-center justify-between px-5 py-4 border-b border-gray-200">
      <h2 id="side-title" class="text-lg font-playfair font-bold">Menú</h2>
      <button id="close-side" class="btn" aria-label="Cerrar menú">✕</button>
    </div>

    <div class="px-5 py-4 space-y-4">
      <!-- Buscador -->
      <form action="{{ url_for('index') }}" method="get" class="flex gap-2">
        <input type="search" name="q" placeholder="Buscar productos…" class="w-full rounded-xl border border-gray-300 px-3 py-2 outline-none focus:ring-2 focus:ring-black" value="{{ request.args.get('q','') }}"/>
        <button class="px-4 py-2 rounded-xl bg-neutral-900 text-white hover:brightness-95">Buscar</button>
      </form>

      <nav class="flex flex-col gap-2 text-[15px]">
        <a href="{{ url_for('index') }}#inicio" class="py-2 hover:underline">Inicio</a>

        <!-- Submenú -->
        <button type="button" class="text-left py-2 hover:underline lg:hidden"
                data-action="toggle-submenu" data-target="submenu-catalogo"
                aria-controls="submenu-catalogo" aria-expanded="false">
          Catálogo ▾
        </button>
        <div id="submenu-catalogo" class="pl-3 mt-1 space-y-2 hidden lg:block">
          <a href="{{ url_for('index') }}#accesorios-pelo" class="block hover:underline">Accesorios para el pelo</a>
          <a href="{{ url_for('index') }}#aros" class="block hover:underline">Aros</a>
          <a href="{{ url_for('index') }}#anillos" class="block hover:underline">Anillos</a>
          <a href="{{ url_for('index') }}#cinturones" class="block hover:underline">Cinturones</a>
          <a href="{{ url_for('index') }}#collares" class="block hover:underline">Collares</a>
          <a href="{{ url_for('index') }}#prendas" class="block hover:underline">Prendas de vestir</a>
        </div>

        <a href="{{ url_for('index') }}#nosotros" class="py-2 hover:underline">Nosotros</a>
        <a href="{{ url_for('index') }}#contacto" class="py-2 hover:underline">Contacto</a>
      </nav>

      {% if current_user.is_authenticated %}
        <div class="pt-2 border-t border-gray-200">
          {% if IS_ADMIN %}
            <a href="{{ url_for('admin.dashboard') }}" class="btn btn-primary w-full text-center">Panel Admin</a>
          {% endif %}
          <a href="{{ url_for('auth.logout') }}" class="btn w-full mt-2 text-center">Salir</a>
        </div>
      {% else %}
        <a href="{{ url_for('auth.login') }}" class="btn">Iniciar sesión</a>
      {% endif %}
    </div>
  </aside>

  <!-- MAIN -->
  <main id="main-content" class="flex-grow">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="container mt-4">
          {% for category, msg in messages %}
            <div class="p-3 mb-2 rounded border
              {% if category == 'success' %} bg-green-50 border-green-200
              {% elif category == 'danger' %} bg-red-50 border-red-200
              {% else %} bg-gray-50 border-gray-200 {% endif %}">
              {{ msg }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  {% include 'partials/cart_panel.html' %}
  <div id="login-modal" class="hidden fixed inset-0 items-center justify-center z-[80]"></div>
  <div id="toast-root" class="fixed bottom-4 right-4 z-[9999] flex flex-col gap-2 pointer-events-none"></div>

  <footer class="mt-12">
    <div class="container flex flex-col md:flex-row items-center justify-between gap-4">
      <div class="text-left">
        <p class="font-playfair font-bold text-lg">FAIGOTHY ✶</p>
        <p class="text-sm">Accesorios hechos a mano</p>
      </div>
      <div class="flex flex-col sm:flex-row items-center gap-6 text-sm">
  <!-- Instagram -->
  <a href="https://instagram.com/faigothy" target="_blank" class="flex items-center gap-2 hover:underline">
    <img src="{{ url_for('static', filename='Instagram.png') }}" alt="Instagram" class="w-5 h-5">
    <span>@faigothy</span>
  </a>

  <!-- Correo -->
  <a href="mailto:contacto@faigothy.com" class="flex items-center gap-2 hover:underline">
    <img src="{{ url_for('static', filename='gmail.png') }}" alt="Email" class="w-5 h-5">
    <span>contacto@faigothy.com</span>
  </a>

  <!-- WhatsApp -->
  <a href="https://wa.link/xhgc3r" target="_blank" class="flex items-center gap-2 hover:underline">
    <img src="{{ url_for('static', filename='whatsapp.png') }}" alt="WhatsApp" class="w-5 h-5">
    <span>WhatsApp</span>
  </a>
</div>
    </div>
    <div class="text-center text-xs text-gray-500 mt-4">© 2025 FAIGOTHY. Todos los derechos reservados.</div>
  </footer>

  <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>