{% extends "layouts.html" %}
{% block content %}
<section class="container section-spacing">
  <h1 class="font-playfair text-2xl sm:text-3xl font-bold mb-4">Tu carrito</h1>

  <div class="grid md:grid-cols-3 gap-6">
    <div class="md:col-span-2 space-y-3">
      {% if not items %}
        <p>Est√° vac√≠o üõçÔ∏è</p>
      {% else %}
        {% for pid, item in items.items() %}
          <div class="border rounded-xl p-3">
            <div class="flex items-start justify-between gap-3">
              <div>
                <p class="font-semibold">{{ item.name }}</p>
                <p class="text-sm mt-1">‚Ç≤ {{ '%.0f'|format(item.price) }} c/u</p>
              </div>
              <p class="font-bold whitespace-nowrap">‚Ç≤ {{ '%.0f'|format(item.price * item.qty) }}</p>
            </div>

            <div class="mt-3 flex items-center gap-2">
              <form action="{{ url_for('cart.update', product_id=pid) }}" method="post" class="inline">
                <input type="hidden" name="qty" value="{{ item.qty - 1 }}">
                <button class="btn" aria-label="Disminuir">-</button>
              </form>
              <span class="px-2">{{ item.qty }}</span>
              <form action="{{ url_for('cart.update', product_id=pid) }}" method="post" class="inline">
                <input type="hidden" name="qty" value="{{ item.qty + 1 }}">
                <button class="btn" aria-label="Aumentar">+</button>
              </form>
              <form action="{{ url_for('cart.remove', product_id=pid) }}" method="post" class="inline">
                <button class="btn">Eliminar</button>
              </form>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>

    <div class="border rounded-2xl p-4 h-max">
      <div class="flex items-center justify-between mb-3">
        <span class="font-semibold">Subtotal</span>
        <span class="font-bold">‚Ç≤ {{ '%.0f'|format(total or 0) }}</span>
      </div>
      <div class="flex gap-2">
        <form action="{{ url_for('cart.clear') }}" method="post">
          <button class="btn">Vaciar</button>
        </form>
        <a href="{{ url_for('checkout') }}" class="btn btn-primary">Finalizar</a>
      </div>
    </div>
  </div>
</section>
{% endblock %}